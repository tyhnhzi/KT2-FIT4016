@page
@model PickleballClub.Pages.Matches.CreateModel
@using PickleballClub.Models

@{
    ViewData["Title"] = "Ghi nhận Trận đấu";
}

<div class="glass-card mt-4 mx-auto fade-in-up" style="max-width: 900px;">
    <h2 class="mb-4 text-center font-weight-bold">Ghi nhận Kết quả Trận đấu</h2>

    <form method="post">
        <div asp-validation-summary="ModelOnly" class="text-danger mb-4"></div>

        <div class="row">
            <div class="col-md-6 mb-4">
                <label asp-for="Match.ChallengeId" class="form-label small text-uppercase opacity-75">Kèo đấu liên quan</label>
                <select asp-for="Match.ChallengeId" class="form-select" asp-items="ViewBag.Challenges">
                    <option value="">-- Trận giao hữu tự do --</option>
                </select>
            </div>
            <div class="col-md-6 mb-4">
                <label asp-for="Match.Format" class="form-label small text-uppercase opacity-75">Thể thức thi đấu</label>
                <select asp-for="Match.Format" class="form-select" asp-items="Html.GetEnumSelectList<MatchFormat>()" id="match-format">
                </select>
            </div>
        </div>

        <hr class="my-4 border-light border-opacity-10">

        <div class="row">
            <div class="col-md-6">
                <h4 class="text-info mb-4 text-uppercase letter-spacing-2 fw-bold"><i class="bi bi-people-fill me-2"></i> TEAM 1</h4>
                <div class="mb-4">
                    <label class="form-label small opacity-75">Người chơi 1</label>
                    <select asp-for="Match.Team1_Player1Id" class="form-select" asp-items="ViewBag.Members">
                        <option value="">-- Chọn thành viên --</option>
                    </select>
                </div>
                <div class="mb-4 doubles-only">
                    <label class="form-label small opacity-75">Người chơi 2</label>
                    <select asp-for="Match.Team1_Player2Id" class="form-select" asp-items="ViewBag.Members">
                        <option value="">-- Chọn thành viên --</option>
                    </select>
                </div>
            </div>
            <div class="col-md-6 border-start border-light border-opacity-10">
                <h4 class="text-warning mb-4 text-uppercase letter-spacing-2 fw-bold"><i class="bi bi-people-fill me-2"></i> TEAM 2</h4>
                <div class="mb-4">
                    <label class="form-label small opacity-75">Người chơi 1</label>
                    <select asp-for="Match.Team2_Player1Id" class="form-select" asp-items="ViewBag.Members">
                        <option value="">-- Chọn thành viên --</option>
                    </select>
                </div>
                <div class="mb-4 doubles-only">
                    <label class="form-label small opacity-75">Người chơi 2</label>
                    <select asp-for="Match.Team2_Player2Id" class="form-select" asp-items="ViewBag.Members">
                        <option value="">-- Chọn thành viên --</option>
                    </select>
                </div>
            </div>
        </div>

        <hr class="my-4 border-light border-opacity-10">

        <div class="row">
            <div class="col-md-12 mb-4">
                <label asp-for="Match.WinningSide" class="form-label small text-uppercase opacity-75 fw-bold">Kết quả chung cuộc</label>
                <select asp-for="Match.WinningSide" class="form-select form-select-lg bg-primary bg-opacity-10 border-info" asp-items="Html.GetEnumSelectList<WinningSide>()">
                </select>
            </div>
        </div>

        <div class="form-check form-switch mt-2 mb-5">
            <input class="form-check-input" type="checkbox" asp-for="Match.IsRanked" checked id="is-ranked">
            <label class="form-check-label ms-2" for="is-ranked">Có tính điểm trình độ (Rank DUPR)</label>
        </div>

        <div class="d-flex justify-content-between pt-4 border-top border-light border-opacity-10">
            <a asp-page="Index" class="btn btn-outline-light px-4 d-flex align-items-center">Hủy bỏ</a>
            <button type="submit" class="btn btn-glass px-5 shadow-lg">Lưu kết quả</button>
        </div>
    </form>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script>
        $(document).ready(function() {
            function toggleDoubles() {
                var format = $('#match-format').val();
                if (format == '1') { // Doubles
                    $('.doubles-only').show();
                } else {
                    $('.doubles-only').hide();
                    $('.doubles-only select').val('');
                }
            }
            $('#match-format').change(toggleDoubles);
            toggleDoubles();
        });
    </script>
}
